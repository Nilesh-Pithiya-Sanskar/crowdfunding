import{N as P,F as E}from"./Footer.fc5addff.js";import{_ as N,o as r,c as l,e,k as u,w as b,F as p,g as h,b as _,t as s,C as g,E as f,p as x,z as D,H as j,r as y,n as G}from"./index.30423bfa.js";import{F as $}from"./FileUploader.f301337d.js";const M={name:"Login",components:{Navbar:P,Footer:E,FileUploader:$},setup(){return{user:D("user")}},data(){return{user_data:"",donation_details:"",donor:"",campaign_details:"",donor_total_donation_amount:0,donor_count_campaign:0,campaign_report:"",edit_profile:!1,email:"",phone:"",first_name:"",last_name:"",pan_number:"",errorPancard:"",password:"",confirmPassword:"",errorMessagePassword:"",errorMessageConfirmPassword:""}},created(){this.user.isLoggedIn()||this.$router.push("/sadbhavna")},mounted(){const t=j();document.title="Profile "+t.params.name,this.get_user_detail(t.params.name),this.get_user_pan(t.params.name),this.get_donation_details(t.params.name),this.get_campaign_details(t.params.name),this.get_details_of_donor_donations(t.params.name),this.get_details_of_ngo_campaigns(t.params.name),this.donor=t.params.name},computed:{},resources:{download_80g(){return{method:"sadbhavna_donatekart.api.donor.download_80g",onSuccess:t=>{console.log("okey",t);let n=`/api/method/frappe.utils.print_format.download_pdf?doctype=Tax Exemption 80G Certificate&name=${t}&format=80G Certificate for Donation`;window.open(n,"_blank")},onError:t=>{console.log("somthing want wrong!",t)}}},get_details_of_donor_donations(){return{method:"sadbhavna_donatekart.api.donor.get_details_of_donor_donations",onSuccess:t=>{this.donor_count_campaign=t[0],this.donor_total_donation_amount=t[1]},onError:t=>{console.log("error",t)}}},get_details_of_ngo_campaigns(){return{method:"sadbhavna_donatekart.api.campaign.get_details_of_ngo_campaigns",onSuccess:t=>{this.campaign_report=t[0]},onError:t=>{console.log("error",t)}}},update_donor(){return{method:"sadbhavna_donatekart.api.donor.update_donor",onSuccess:t=>{this.$toast({title:"Profile Updated",text:"Your Profile is successfully updated.",icon:"check",position:"top-center"}),this.$router.go(-1)},onError:t=>{console.log("error",t),this.$toast({title:"Error",text:t,icon:"x-circle",appearance:"denger",position:"top-center"})}}},set_image(){return{method:"sadbhavna_donatekart.api.donor.set_image",onSuccess:t=>{this.$toast({title:"Profile Picture Updated",text:"Your Profile Picture is successfully updated.",icon:"check",position:"top-center"}),this.$router.go()},onError:t=>{console.log("error",t),this.$toast({title:"Error",text:t,icon:"x-circle",appearance:"denger",position:"top-center"})}}}},methods:{get_user_detail(t){let n="/api/resource/User/"+t;fetch(n,{method:"GET"}).then(d=>{d.json().then(c=>{this.user_data=c,this.email=c.data.email,this.phone=c.data.phone,this.first_name=c.data.first_name,this.last_name=c.data.last_name})}).catch(d=>{console.error(d)})},get_user_pan(t){let n=`/api/resource/Donor?filters=[["email", "=", ${t}]]`;fetch(n,{method:"GET"}).then(d=>{console.log("response",d),d.json().then(c=>{console.log("res",c)})}).catch(d=>{console.error(d)})},get_donation_details(t){let n=`/api/resource/Donation?filters={"email": "${t}"}&fields=["*"]`;fetch(n,{method:"GET"}).then(d=>{d.json().then(c=>{this.donation_details=c})}).catch(d=>{console.log(d)})},download_80g(t,n){this.$resources.download_80g.submit({donation:t,date:n,donor:this.donor})},get_campaign_details(t){let n=`/api/resource/NGO?filters={"email": "${t}"}&fields=["name"]`;fetch(n,{method:"GET"}).then(d=>{d.json().then(c=>{let m=`/api/resource/Donation Campaign?filters={"ngo": "${c.data[0].name}"}&fields=["*"]`;fetch(m,{method:"GET"}).then(w=>{w.json().then(v=>{this.campaign_details=v.data})})})}).catch(d=>{console.log(d)})},get_details_of_donor_donations(t){this.$resources.get_details_of_donor_donations.submit({donor:t})},get_details_of_ngo_campaigns(t){this.$resources.get_details_of_ngo_campaigns.submit({ngo:t})},edit(){this.edit_profile=!0},save(){var t=/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$/;if(this.password==""?this.errorMessagePassword="Enter password":t.test(this.password)==!1&&(this.errorMessagePassword="Enter strong password, minimum eight characters, at least one letter, one number and one special character",console.log("pw")),this.confirmPassword==""&&(this.errorMessageConfirmPassword="Enter confirm password"),this.password!==this.confirmPassword)return this.errorMessageConfirmPassword="Confirm Password must be same of password",!0;this.edit_profile=!1,this.$resources.update_donor.submit({first_name:this.first_name,last_name:this.last_name,phone:this.phone,old_email:this.donor,password:this.password!=""?this.password:"",pan_number:this.pan_number})},cancel(){this.edit_profile=!1},upload_image(t){alert("clicked",t),console.log("url",t),this.$resources.set_image.submit({name:this.donor,user_image:t})}}},T={key:0,class:"profile-page"},S={class:"h-500-px bg-blueGray-200"},U={class:"pb-4 bg-blueGray-200"},F={class:"container mx-auto px-4 pt-96"},q={class:"relative flex flex-col min-w-0 break-words bg-white w-full mb-6 shadow-xl rounded-lg -mt-64"},V={class:"px-6"},Y={class:"grid grid-cols-3"},A=e("div",null,null,-1),L={class:"grid justify-items-center profile"},R={key:0,class:"relative"},z=["src"],B={class:"shadow-xl rounded-full align-middle border-none absolute ml-12 mt-16 lg:ml-16"},H=["onClick"],I=e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},null,-1),K=e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1),Z=[I,K],O={key:1,class:"relative"},J=e("img",{src:"https://crowdfunding.frappe.cloud/files/default_profile.jpeg",class:"shadow-xl rounded-full h-40 align-middle border-2 border-solid border-gray-300 absolute -m-16 -ml-20 lg:-ml-16 max-w-200-px"},null,-1),Q={class:"shadow-xl rounded-full align-middle border-none absolute ml-12 mt-16 lg:ml-16"},W=["onClick"],X=e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},null,-1),ee=e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},null,-1),te=[X,ee],se=e("div",null,null,-1),oe={class:"grid lg:grid-cols-3 md:grid-cols-3 sm:grid-cols-1 justify-center"},ne={class:""},ae={class:""},re={key:0,class:"flex justify-center pt-8"},le={class:"w-28 text-center"},ie={class:"text-xl font-bold block uppercase tracking-wide text-green-500"},de={class:"text-sm text-blueGray-500"},ce={class:"w-28 text-center"},_e={class:"text-xl font-bold block uppercase tracking-wide text-green-500"},me={class:"text-sm text-blueGray-500"},ue={key:1,class:""},pe=e("div",null,null,-1),he={class:""},ge={key:0,class:"flex justify-center pt-8"},fe={key:1,class:"flex justify-center"},xe={class:"w-28 text-center"},be={class:"text-xl font-bold block uppercase tracking-wide text-green-500"},ve={class:"text-sm text-blueGray-500"},ye={class:"w-28 text-center"},we={class:"text-xl font-bold block uppercase tracking-wide text-blue-500"},ke={class:"text-sm text-blueGray-500"},Ce={class:"w-28 text-center"},Pe={class:"text-xl font-bold block uppercase tracking-wide text-red-500"},Ee={class:"text-sm text-blueGray-500"},Ne=e("div",{class:"flex flex-wrap justify-center"},null,-1),De={class:"mt-10"},je={class:"container mx-auto h-full"},Ge={class:"w-full bg-grey-lightest"},$e={class:"container mx-auto py-0"},Me={class:"w-4/6 lg:w:4/6 mx-auto bg-white"},Te={class:""},Se={key:0,class:"text-center"},Ue={class:"text-3xl font-semibold leading-normal mb-2 text-blueGray-700"},Fe={class:"text-sm leading-normal mt-0 mb-2 text-blueGray-400 font-bold uppercase"},qe={key:1,class:"text-center"},Ve={class:"grid lg:grid-cols-2 md:grid-cols-2 sm:grid-cols-1 gap-4 mb-4 lg:mr-8 sm:ml-0 lg:ml-8 sm:ml-0"},Ye={class:"block text-grey-darker text-sm font-bold mb-2",for:"first_name"},Ae={class:"block text-grey-darker text-sm font-bold mb-2",for:"last_name"},Le={class:"mb-4 lg:mr-8 sm:ml-0 lg:ml-8 sm:ml-0"},Re={class:"block text-grey-darker text-sm font-bold mb-2",for:"number"},ze=e("span",{class:"text-red-600"},"*",-1),Be={class:"mb-4 lg:mr-8 sm:ml-0 lg:ml-8 sm:ml-0"},He={class:"block text-grey-darker text-sm font-bold mb-2",for:"pan number"},Ie={class:"mb-4 lg:mr-8 sm:ml-0 lg:ml-8 sm:ml-0"},Ke={class:"block text-grey-darker text-sm font-bold mb-2",for:"number"},Ze=e("span",{class:"text-red-600"},null,-1),Oe={class:"text-red-600"},Je={key:0,class:"mb-4 lg:mr-8 sm:ml-0 lg:ml-8 sm:ml-0"},Qe={class:"block text-grey-darker text-sm font-bold mb-2",for:"number"},We=e("span",{class:"text-red-600"},"*",-1),Xe={class:"text-red-600"},et={class:"grid justify-items-center"},tt={key:0,class:"mt-4 sm:mt-2"},st={key:0},ot={key:0,class:"text-center pt-4 text-2xl text-gray-600"},nt={key:1,class:"flex flex-col"},at={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},rt={class:"py-2 inline-block min-w-full sm:px-6 lg:px-8"},lt={class:"overflow-hidden"},it={class:"min-w-full"},dt={class:"bg-white border-b"},ct={scope:"col",class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},_t={scope:"col",class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},mt={scope:"col",class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},ut={scope:"col",class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},pt={class:"bg-white border-b transition duration-300 ease-in-out hover:bg-gray-100"},ht={class:"text-sm text-gray-900 font-light px-6 py-4"},gt={class:"text-sm text-gray-900 font-light px-6 py-4"},ft={class:"text-sm text-gray-900 font-light px-6 py-4"},xt=["onClick"],bt={key:2},vt={class:"text-center font-bold text-gray-500"},yt={class:"text-center text-sm leading-normal mt-2 mb-5 text-blue-400 font-bold"},wt={key:1},kt={key:0,class:"text-center text-2xl text-gray-600"},Ct={key:1,class:"flex flex-col"},Pt={class:"overflow-x-auto sm:-mx-6 lg:-mx-8"},Et={class:"py-2 inline-block min-w-full sm:px-6 lg:px-8"},Nt={class:"overflow-hidden"},Dt={class:"min-w-full"},jt={class:"bg-white border-b"},Gt={scope:"col",class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},$t={scope:"col",class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},Mt={scope:"col",class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},Tt={scope:"col",class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},St={scope:"col",class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},Ut={scope:"col",class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},Ft={scope:"col",class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},qt={class:"bg-white border-b transition duration-300 ease-in-out hover:bg-gray-100"},Vt={class:"text-sm text-gray-900 font-light px-6 py-4"},Yt={class:"text-sm text-gray-900 font-light px-6 py-4"},At={class:"text-sm text-gray-900 font-light px-6 py-4"},Lt={class:"text-sm text-green-500 font-bold px-6 py-4"},Rt={class:"text-sm text-gray-900 font-light px-6 py-4"},zt={class:"text-sm text-gray-900 font-light px-6 py-4"},Bt={class:"text-center text-sm leading-normal m-4 text-blue-400 font-bold"},Ht={key:2},It={class:"text-center font-bold text-gray-500"},Kt={class:"text-center text-sm leading-normal mt-2 mb-5 text-blue-400 font-bold"};function Zt(t,n,d,c,o,m){const w=y("Navbar"),v=y("FileUploader"),k=y("router-link"),C=y("Footer");return o.user_data?(r(),l("main",T,[e("section",S,[u(w),e("div",U,[e("div",F,[e("div",q,[e("div",V,[e("div",Y,[A,e("div",null,[e("div",L,[o.user_data.data.user_image?(r(),l("div",R,[e("img",{src:o.user_data.data.user_image,class:"shadow-xl rounded-full h-40 align-middle border-none absolute -m-16 -ml-20 lg:-ml-16 max-w-200-px"},null,8,z),e("div",B,[u(v,{onSuccess:n[0]||(n[0]=a=>m.upload_image(a.file_url))},{default:b(({openFileSelector:a})=>[(r(),l("svg",{onClick:a,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-edit"},Z,8,H))]),_:1})])])):(r(),l("div",O,[e("div",null,[J,e("div",Q,[u(v,{onSuccess:n[1]||(n[1]=a=>m.upload_image(a.file_url))},{default:b(({openFileSelector:a})=>[(r(),l("svg",{onClick:a,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-edit"},te,8,W))]),_:1})])])]))])]),se]),e("div",oe,[e("div",ne,[o.user_data?(r(!0),l(p,{key:0},h(o.user_data.data.roles,a=>(r(),l("div",ae,[a.role=="Donor"?(r(),l("div",re,[e("div",le,[e("span",ie,s(o.donor_count_campaign),1),e("span",de,s(t.$t("Total Donation Campaign")),1)]),e("div",ce,[e("span",_e,s(o.donor_total_donation_amount),1),e("span",me,s(t.$t("Total Donate Amount")),1)])])):a.role=="Ngo"?(r(),l("div",ue)):_("",!0)]))),256)):_("",!0)]),pe,e("div",null,[o.user_data?(r(!0),l(p,{key:0},h(o.user_data.data.roles,a=>(r(),l("div",he,[a.role=="Donor"?(r(),l("div",ge)):a.role=="Ngo"?(r(),l("div",fe,[e("div",xe,[e("span",be,s(o.campaign_report.total_live_campaign||0),1),e("span",ve,s(t.$t("Total Live Campaign")),1)]),e("div",ye,[e("span",we,s(o.campaign_report.total_pending_campaign||0),1),e("span",ke,s(t.$t("Total Pending Campaign")),1)]),e("div",Ce,[e("span",Pe,s(o.campaign_report.total_rejected_campaign||0),1),e("span",Ee,s(t.$t("Total Rejected Campaign")),1)])])):_("",!0)]))),256)):_("",!0)])]),Ne,e("div",De,[e("div",je,[e("div",Ge,[e("div",$e,[e("div",Me,[e("form",null,[e("div",Te,[o.edit_profile?(r(),l("div",qe,[e("div",Ve,[e("div",null,[e("label",Ye,s(t.$t("First Name")),1),g(e("input",{class:"appearance-none form-control block border rounded w-full text-grey-darker","onUpdate:modelValue":n[2]||(n[2]=a=>o.first_name=a),placeholder:"Your first name",type:"text",required:""},null,512),[[f,o.first_name]])]),e("div",null,[e("label",Ae,s(t.$t("Last Name")),1),g(e("input",{class:"appearance-none border form-control block rounded w-full text-grey-darker","onUpdate:modelValue":n[3]||(n[3]=a=>o.last_name=a),type:"text",placeholder:"Your last name",required:""},null,512),[[f,o.last_name]])])]),e("div",Le,[e("label",Re,[x(s(t.$t("Phone Number"))+" ",1),ze]),g(e("input",{class:"appearance-none border form-control block rounded w-full py-2 text-grey-darker","onUpdate:modelValue":n[4]||(n[4]=a=>o.phone=a),type:"number",placeholder:"Your phone number",required:""},null,512),[[f,o.phone]])]),e("div",Be,[e("label",He,s(t.$t("Pan Number")),1),g(e("input",{class:"appearance-none border rounded w-full py-2 px-3 text-grey-darker","onUpdate:modelValue":n[5]||(n[5]=a=>o.pan_number=a),type:"text",placeholder:"Your pan number",required:""},null,512),[[f,o.pan_number]])]),e("div",Ie,[e("label",Ke,[x(s(t.$t("Set New Password"))+" ",1),Ze]),g(e("input",{class:"appearance-none border form-control block rounded w-full py-2 text-grey-darker",type:"password","onUpdate:modelValue":n[6]||(n[6]=a=>o.password=a),onKeyup:n[7]||(n[7]=a=>o.errorMessagePassword=""),placeholder:"Enter New Password"},null,544),[[f,o.password]]),e("p",Oe,s(t.$t(o.errorMessagePassword)),1)]),o.password!=""?(r(),l("div",Je,[e("label",Qe,[x(s(t.$t("Confirm Password"))+" ",1),We]),g(e("input",{class:"appearance-none border form-control block rounded w-full py-2 text-grey-darker",type:"password","onUpdate:modelValue":n[8]||(n[8]=a=>o.confirmPassword=a),onKeyup:n[9]||(n[9]=a=>o.errorMessageConfirmPassword=""),placeholder:"Enter Again Password",required:""},null,544),[[f,o.confirmPassword]]),e("p",Xe,s(t.$t(o.errorMessageConfirmPassword)),1)])):_("",!0),e("button",{onClick:n[10]||(n[10]=a=>m.save()),class:"bg-green-500 uppercase text-white font-bold hover:bg-white hover:text-green-500 hover:outline hover:outline-1 hover:outline-offset-1 shadow text-xs px-4 py-2 rounded mr-2 mb-4 ease-linear transition-all duration-150",type:"button"},s(t.$t("Save")),1),e("button",{onClick:n[11]||(n[11]=a=>m.cancel()),class:"bg-gray-500 uppercase text-white font-bold hover:bg-white hover:text-green-500 hover:outline hover:outline-1 hover:outline-offset-1 shadow text-xs px-4 py-2 rounded mr-2 mb-4 ease-linear transition-all duration-150",type:"button"},s(t.$t("cancel")),1)])):(r(),l("div",Se,[e("h3",Ue,s(o.user_data.data.full_name),1),e("div",Fe,[e("div",null,s(o.user_data.data.email),1),e("div",null,s(o.user_data.data.phone),1)])])),(r(!0),l(p,null,h(o.user_data.data.roles,a=>(r(),l("div",et,[a.role=="Donor"?(r(),l("div",tt,[o.edit_profile?_("",!0):(r(),l("button",{key:0,onClick:n[12]||(n[12]=i=>m.edit()),class:"bg-green-500 uppercase text-white font-bold hover:bg-white hover:text-green-500 hover:outline hover:outline-1 hover:outline-offset-1 shadow text-xs px-4 py-2 rounded ease-linear transition-all duration-150",type:"button"},s(t.$t("Edit Profile")),1))])):_("",!0)]))),256))])])])])])])]),o.user_data?(r(!0),l(p,{key:0},h(o.user_data.data.roles,a=>(r(),l("div",null,[a.role=="Donor"?(r(),l("div",st,[o.donation_details.data!=""?(r(),l("div",ot,s(t.$t("Your Donations")),1)):_("",!0),o.donation_details.data!=""?(r(),l("div",nt,[e("div",at,[e("div",rt,[e("div",lt,[e("table",it,[e("thead",dt,[e("tr",null,[e("th",ct,s(t.$t("Campaign Name")),1),e("th",_t,s(t.$t("Amount")),1),e("th",mt,s(t.$t("Date")),1),e("th",ut,s(t.$t("Download 80G Certificate")),1)])]),e("tbody",null,[(r(!0),l(p,null,h(o.donation_details.data,i=>(r(),l("tr",pt,[e("td",ht,s(i.name),1),e("td",gt,s(i.amount),1),e("td",ft,s(i.date),1),e("td",{class:"text-sm text-gray-900 font-light px-6 py-4 cursor-pointer",onClick:Ot=>m.download_80g(i.name,i.date)},s(t.$t("Download")),9,xt)]))),256))])])])])])])):(r(),l("div",bt,[e("div",vt,s(t.$t("Donate Item to see Donations and Download Certificate")),1),e("div",yt,[u(k,{to:"/sadbhavna"},{default:b(()=>[x(s(t.$t("Click Here To Explore Campaign")),1)]),_:1})])]))])):a.role=="Ngo"?(r(),l("div",wt,[o.campaign_details.data!=""?(r(),l("div",kt,s(t.$t("Your Campaign")),1)):_("",!0),o.campaign_details.data!=""?(r(),l("div",Ct,[e("div",Pt,[e("div",Et,[e("div",Nt,[e("table",Dt,[e("thead",jt,[e("tr",null,[e("th",Gt,s(t.$t("Campaign Name")),1),e("th",$t,s(t.$t("Campaign Category")),1),e("th",Mt,s(t.$t("Requested Amount")),1),e("th",Tt,s(t.$t("Raised Amount")),1),e("th",St,s(t.$t("Start Date")),1),e("th",Ut,s(t.$t("End Date")),1),e("th",Ft,s(t.$t("Status")),1)])]),e("tbody",null,[(r(!0),l(p,null,h(o.campaign_details,i=>(r(),l("tr",qt,[e("td",Vt,s(i.campaign_title),1),e("td",Yt,s(i.campaign_category),1),e("td",At,s(i.donation_amount),1),e("td",Lt,s(i.raised_amount),1),e("td",Rt,s(i.start_date),1),e("td",zt,s(i.end_date),1),e("td",{class:G(["text-sm font-bold px-6 py-4",i.status==="Live"?"text-green-500":"",i.status==="Pending"?"text-blue-500":"",i.status==="Rejected"?"text-red-500":"",i.status==="Closed"?"text-orange-500":""])},s(i.status),3)]))),256))])])]),e("div",Bt,[u(k,{to:"/sadbhavna/request-campaign"},{default:b(()=>[x(s(t.$t("Request New Campaign")),1)]),_:1})])])])])):(r(),l("div",Ht,[e("div",It,s(t.$t("You don't have any campaign live yet.")),1),e("div",Kt,[u(k,{to:"/sadbhavna/request-campaign"},{default:b(()=>[x(s(t.$t("Click Here To Request A New Campaign")),1)]),_:1})])]))])):_("",!0)]))),256)):_("",!0)])])])]),u(C)])])):_("",!0)}var Xt=N(M,[["render",Zt]]);export{Xt as default};
